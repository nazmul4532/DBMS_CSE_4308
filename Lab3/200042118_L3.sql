CREATE TABLE ACCOUNT
(
ACCOUNT_NO CHAR (5),
BALANCE NUMBER NOT NULL,
CONSTRAINT PK_ACCOUNT_NO PRIMARY KEY (ACCOUNT_NO)
);

CREATE TABLE CUSTOMER
(
CUSTOMER_NO CHAR (5),
CUSTOMER_NAME VARCHAR2 (20) NOT NULL,
CUSTOMER_CITY VARCHAR2 (10),
CONSTRAINT PK_CUSTOMER_NO  PRIMARY KEY (CUSTOMER_NO)
);

CREATE TABLE DEPOSITOR
(
ACCOUNT_NO CHAR (5),
CUSTOMER_NO CHAR (5),
CONSTRAINT PK_ACCOUNT_NO_CUSTOMER_NO PRIMARY KEY (ACCOUNT_NO, CUSTOMER_NO)
);

ALTER TABLE CUSTOMER ADD DATE_OF_BIRTH DATE;

ALTER TABLE ACCOUNT MODIFY BALANCE NUMBER(12,2);

ALTER TABLE DEPOSITOR RENAME COLUMN ACCOUNT_NO TO A_NO;

ALTER TABLE DEPOSITOR RENAME COLUMN CUSTOMER_NO TO C_NO;

ALTER TABLE DEPOSITOR RENAME TO DEPOSITOR_INFO;

ALTER TABLE DEPOSITOR_INFO ADD CONSTRAINT FK_DEPOSITOR_ACCOUNT FOREIGN KEY (A_NO)
REFERENCES ACCOUNT(ACCOUNT_NO);


ALTER TABLE DEPOSITOR_INFO ADD CONSTRAINT FK_DEPOSITOR_CUSTOMER FOREIGN KEY (C_NO)
REFERENCES CUSTOMER(CUSTOMER_NO);

INSERT INTO ACCOUNT VALUES ('A-101', 45320);
INSERT INTO ACCOUNT VALUES ('A-102', 54230000);
INSERT INTO ACCOUNT VALUES ('A-103', 200042118);
INSERT INTO ACCOUNT VALUES ('A-104', 200042150);
INSERT INTO ACCOUNT VALUES ('A-105', 500);
INSERT INTO ACCOUNT VALUES ('A-106', 10000);
INSERT INTO ACCOUNT VALUES ('A-107', 200042113);

INSERT INTO CUSTOMER VALUES ('C-101', 'NAZMUL', 'DHK', '16-JUL-00');
INSERT INTO CUSTOMER VALUES ('C-102', 'SHAKKHOR', 'KHL', '09-SEP-01');
INSERT INTO CUSTOMER VALUES ('C-103', 'TANZIM', 'DHK', '07-SEP-01');
INSERT INTO CUSTOMER VALUES ('C-104', 'RIDUN', 'KHL', '19-DEC-01');
INSERT INTO CUSTOMER VALUES ('C-105', 'AYESHA', 'KHL', '6-APR-00');
INSERT INTO CUSTOMER VALUES ('C-106', 'SHANTA', 'DHK', '24-MAR-01');
INSERT INTO CUSTOMER VALUES ('C-107', 'NAFISA', 'DHK', '6-APR-01');

INSERT INTO DEPOSITOR_INFO VALUES ('A-101', 'C-101');
INSERT INTO DEPOSITOR_INFO VALUES ('A-102', 'C-102');
INSERT INTO DEPOSITOR_INFO VALUES ('A-103', 'C-103');
INSERT INTO DEPOSITOR_INFO VALUES ('A-104', 'C-104');
INSERT INTO DEPOSITOR_INFO VALUES ('A-105', 'C-105');
INSERT INTO DEPOSITOR_INFO VALUES ('A-106', 'C-106');

SELECT ACCOUNT_NO FROM ACCOUNT WHERE BALANCE > 100000;

SELECT CUSTOMER_NAME FROM CUSTOMER WHERE CUSTOMER_CITY = 'DHK';

SELECT CUSTOMER_NO FROM CUSTOMER WHERE CUSTOMER_NAME LIKE 'A%';

SELECT DISTINCT A_NO FROM DEPOSITOR_INFO;

SELECT * FROM ACCOUNT, DEPOSITOR_INFO;

SELECT *
FROM CUSTOMER NATURAL JOIN DEPOSITOR_INFO;

SELECT CUSTOMER_NAME FROM DEPOSITOR_INFO,CUSTOMER WHERE DEPOSITOR_INFO.C_NO = CUSTOMER.CUSTOMER_NO;


SELECT CUSTOMER_NAME, CUSTOMER_CITY
FROM CUSTOMER,ACCOUNT,DEPOSITOR_INFO WHERE DEPOSITOR_INFO.A_NO = ACCOUNT.ACCOUNT_NO AND DEPOSITOR_INFO.C_NO = CUSTOMER.CUSTOMER_NO;

SELECT CUSTOMER_NO,CUSTOMER_NAME, CUSTOMER_CITY
FROM CUSTOMER,ACCOUNT,DEPOSITOR_INFO WHERE DEPOSITOR_INFO.A_NO = ACCOUNT.ACCOUNT_NO AND DEPOSITOR_INFO.C_NO = CUSTOMER.CUSTOMER_NO AND ACCOUNT.BALANCE > 1000;

SELECT CUSTOMER_NO,CUSTOMER_NAME, CUSTOMER_CITY
FROM CUSTOMER,ACCOUNT,DEPOSITOR_INFO WHERE DEPOSITOR_INFO.A_NO = ACCOUNT.ACCOUNT_NO AND DEPOSITOR_INFO.C_NO = CUSTOMER.CUSTOMER_NO AND ACCOUNT.BALANCE >= 5000 AND ACCOUNT.BALANCE <=10000 AND CUSTOMER.CUSTOMER_CITY = 'KHL' ;